this is chapter 4 on the master branch